<ng-template #detailsTemplate let-message="message">
	<div [innerHtml]="flowDetails"></div>
</ng-template>
<ng-template #statsTemplate let-message="message">
	<div class="container-fluid">
	  <div class="row" [innerHtml]="flowStatistic"></div>
	</div>
</ng-template>

  
<td id="flowRowID" [hidden]="!flowRowID">
  <a [routerLink]="['../flow', flow.id]">{{ flow.id }}</a>
</td>

<td>
  <div class="container" style="width: 200%">
    <div class="btn-group-justified row" role="group">
	    <div class="col">
      <div class="btn-group" role="group" *ngFor="let fromEndpoint of fromEndpoint; let i = index">
        <button
          [ngClass]="{
            'btn-outline-primary': statusFlow === 'inactive',
            'btn-outline-success': statusFlow === 'active',
            'btn-outline-secondary': statusFlow === 'paused',
            'btn-outline-danger': statusFlow === 'inactiveError'
          }"
          type="button"
          class="btn btn-sm"
          placement="right"
          triggers="mouseenter:mouseleave"
          popoverTitle="From Endpoint"
          [popover]="fromEndpointTooltips[i]"
          (click)="navigateToEndpointEditor('edit','connector',fromEndpoint)"
  		  style="min-width: 12em"
        >
          <span>{{ fromEndpoint.componentType.toUpperCase() }}</span>
        </button>
      </div>
      <div class="btn-group" role="group" style="margin-left: 0.5em;">
        <button
          [ngClass]="{
            'btn-primary': statusFlow === 'inactive',
            'btn-success': statusFlow === 'active',
            'btn-secondary': statusFlow === 'paused',
            'btn-danger': statusFlow === 'inactiveError'
          }"
          type="button"
          (click)="start()"
          class="btn btn-sm"
          [disabled]="disableActionBtns"
          *ngIf="!isFlowStarted"
        >
		 <fa-icon icon="play"></fa-icon>
        </button>
        <button
          [ngClass]="{
            'btn-primary': statusFlow === 'inactive',
            'btn-success': statusFlow === 'active',
            'btn-secondary': statusFlow === 'paused',
            'btn-danger': statusFlow === 'inactiveError'
          }"
          type="button"
          (click)="restart()"
          class="btn btn-sm"
          [disabled]="disableActionBtns"
          *ngIf="!isFlowRestarted"
        >
          <fa-icon icon="sync"></fa-icon>
        </button>
        <button
          [ngClass]="{
            'btn-primary': statusFlow === 'inactive',
            'btn-success': statusFlow === 'active',
            'btn-secondary': statusFlow === 'paused',
            'btn-danger': statusFlow === 'inactiveError'
          }"
          type="button"
          (click)="pause()"
          class="btn btn-sm"
          [disabled]="(!isFlowPaused && isFlowStopped) || disableActionBtns"
          *ngIf="!isFlowPaused"
        >
          <fa-icon icon="pause"></fa-icon>
        </button>
        <button
          [ngClass]="{
            'btn-primary': statusFlow === 'inactive',
            'btn-success': statusFlow === 'active',
            'btn-secondary': statusFlow === 'paused',
            'btn-danger': statusFlow === 'inactiveError'
          }"
          type="button"
          (click)="resume()"
          class="btn btn-sm"
          [disabled]="disableActionBtns"
          *ngIf="!isFlowResumed"
        >
          <fa-icon icon="step-forward"></fa-icon>
        </button>
        <button
          [ngClass]="{
            'btn-primary': statusFlow === 'inactive',
            'btn-success': statusFlow === 'active',
            'btn-secondary': statusFlow === 'paused',
            'btn-danger': statusFlow === 'inactiveError'
          }"
          type="button"
          (click)="stop()"
          class="btn btn-sm"
          [disabled]="isFlowStopped || disableActionBtns"
        >
          <fa-icon icon="stop"></fa-icon>
        </button>
        <button
          [ngClass]="{
            'btn-primary': statusFlow === 'inactive',
            'btn-success': statusFlow === 'active',
            'btn-secondary': statusFlow === 'paused',
            'btn-danger': statusFlow === 'inactiveError'
          }"		  
          type="button"
          data-container="body"		  
          class="btn btn-sm btn-block btn-arrow-right text-left"
          placement="right"
          triggers="mouseenter:mouseleave"
          popoverTitle="Status"
          [ngbPopover]="statusFlowButtonTemplate"
          [autoClose]="'outside'"
		  style="min-width: 20em"
        >
          <span style="text-transform: uppercase">{{ flow.name }}</span>
        </button>
      </div>
      <div class="btn-group" role="group" style="margin-left: 1em" *ngFor="let toEndpoint of toEndpoints; let i = index">
        <button
          [ngClass]="{
            'btn-outline-primary': statusFlow === 'inactive',
            'btn-outline-success': statusFlow === 'active',
            'btn-outline-secondary': statusFlow === 'paused',
            'btn-outline-danger': statusFlow === 'inactiveError'
          }"
          type="button"
          class="btn btn-sm btn-block"
          placement="right"
          triggers="mouseenter:mouseleave"
          popoverTitle="To Endpoint"
          [popover]="toEndpointsTooltips[i]"
          (click)="navigateToEndpointEditor('edit','connector',toEndpoint)"
   		  style="min-width: 12em"

        >
          <span>{{ toEndpoint.componentType.toUpperCase() }}</span>
        </button>
      </div>
      <div class="btn-group" role="group" style="margin-left: 1em" *ngFor="let responseEndpoint of responseEndpoints; let i = index">
        <button
          [ngClass]="{
            'btn-outline-primary': statusFlow === 'inactive',
            'btn-outline-success': statusFlow === 'active',
            'btn-outline-secondary': statusFlow === 'paused',
            'btn-outline-danger': statusFlow === 'inactiveError'
          }"
          type="button"
          class="btn btn-sm btn-block"
          data-container="body"
          placement="right"
          triggers="mouseenter:mouseleave"
          popoverTitle="Response Endpoint"
          [popover]="responseEndpointTooltips[i]"
          (click)="navigateToEndpointEditor('edit','connector',responseEndpoint)"
		  style="width: 12em"
        >
          <span>{{ responseEndpoint.componentType.toUpperCase() }}</span>
        </button>
      </div>
    </div>
	</div>
	<div class="row">
    <div class="col">
      <i
        aria-hidden="true"
        data-container="body"
        (mouseenter)="getFlowDetails()"
        triggers="mouseenter:mouseleave"
        placement="right"
        popoverTitle="Details"
        [popover]="detailsTemplate"
      ><fa-icon icon="info"></fa-icon></i>
      <i
        style="padding-left: 1em"
        (mouseenter)="getFlowStats(flow)"
        (mouseleave)="stopGetFlowStats()"
        data-container="body"
        [hidden]="!isFlowStatusOK"
        triggers="mouseenter:mouseleave"
        placement="right"
        popoverTitle="Stats"
        popover-class="increase-popover-width"
        [popover]="statsTemplate"
        class="stats"
      >
	  <fa-icon icon="chart-bar"></fa-icon>
	  </i>
      <i
        [hidden]="isFlowStatusOK"
        style="padding-left: 1em"
        placement="right"
        triggers="mouseenter:mouseleave"
        popoverTitle="Stats"
        [popover]="statsTemplate">
		<fa-icon icon="chart-bar"></fa-icon>
	  </i>
      <a
        style="padding-left: 1em"
        (click)="navigateToFlowEditor('edit','connector')"
        aria-hidden="true"
        placement="right"
        title="Edit flow"
      ><fa-icon icon="edit"></fa-icon></a>
      <a style="padding-left: 1em" (click)="navigateToFlowEditor('clone','connector')" placement="right" title="Clone flow">
		<fa-icon icon="clone"></fa-icon>
	  </a>
      <a style="padding-left: 1em" (click)="navigateToFlowEditor('delete','')" placement="right" title="Delete flow">
	  		<fa-icon icon="trash"></fa-icon>
	  </a>
    </div>
  </div>
    </div>
</td>


<td id="flowRowID" [hidden]="!flowRowID">
  <a *ngIf="flow.gatewayId" [routerLink]="['../gateway', flow.gatewayId]">{{ flow.gatewayId }}</a>
</td>
<td id="flowErrorEndpointID" [hidden]="!flowRowErrorEndpointID"></td>
<td class="text-right">
  <div class="float-right" style="margin-right: 30px">
    <ng-template #statusFlowButtonTemplate let-message="message">
      <div [innerHtml]="flowStatusButton"></div>
    </ng-template>
    <h4 class="float-right">
      <ng-template #alertsFlowButtonTemplate let-message="message">
        <div [innerHtml]="flowAlertsButton"></div>
      </ng-template>
    </h4>
    <h5 class="float-right" style="margin-left: 10px; vertical-align: top">
      <span
        class="badge badge-warning fa fa-exclamation-triangle"
        *ngIf="flowAlerts === 'true'"
        (mouseenter)="(p != p)"
        placement="left"
        on-mouseover="getFlowAlerts(flow.id)"
        triggers="mouseenter"
        popoverTitle="Show last alerts"
        [ngbPopover]="alertsFlowButtonTemplate"
        [autoClose]="'outside'"
      >
        <span *ngIf="numberOfAlerts > 1">{{ numberOfAlerts }} Alerts</span>
        <span *ngIf="numberOfAlerts == 1">1 Alert</span>
      </span>
    </h5>
  </div>
</td>
